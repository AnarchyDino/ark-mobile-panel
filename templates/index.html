<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARK OPS: UNLOCKED</title>
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg:#050505; --panel:#121212; --accent:#00ff00; --danger:#ff0044; --warn:#ffcc00; --text:#fff; }
        body { background:var(--bg); color:var(--text); font-family:'Roboto',sans-serif; margin:0; padding-bottom:100px; }
        * { box-sizing:border-box; }
        
        /* HEADER */
        .header { background:var(--panel); border-bottom:2px solid var(--accent); padding:15px; position:sticky; top:0; z-index:100; display:flex; justify-content:space-between; align-items:center; }
        h1 { font-family:'Black Ops One'; margin:0; color:var(--accent); font-size:1.5rem; }
        .status { font-size:0.7rem; font-weight:bold; color:#666; }
        .status.on { color:var(--accent); text-shadow:0 0 5px var(--accent); }

        /* UI ELEMENTS */
        .view { display:none; padding:15px; }
        .view.active { display:block; animation:fade 0.3s; }
        @keyframes fade { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
        
        .card { background:var(--panel); border:1px solid #333; border-radius:8px; padding:15px; margin-bottom:15px; }
        h2 { font-family:'Black Ops One'; font-size:1.2rem; margin-top:0; border-bottom:1px solid #333; padding-bottom:5px; color:#aaa; }

        .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
        .grid-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:5px; }

        .btn { width:100%; padding:15px; border:none; background:#222; color:#ccc; font-weight:bold; border-radius:4px; text-transform:uppercase; font-size:0.8rem; cursor:pointer; }
        .btn:active { transform:scale(0.98); }
        .btn-main { background:var(--accent); color:black; }
        .btn-danger { background:var(--danger); color:white; }
        .btn-warn { background:var(--warn); color:black; }
        
        input, select { width:100%; padding:12px; background:#000; border:1px solid #444; color:white; margin-bottom:10px; border-radius:4px; font-size:1rem; }
        
        #console { background:#000; height:150px; overflow-y:auto; padding:10px; font-family:monospace; font-size:0.8rem; border:1px solid #333; margin-bottom:10px; color:#0f0; }

        .nav { position:fixed; bottom:0; width:100%; background:#111; border-top:1px solid #333; display:flex; height:70px; z-index:90; }
        .nav-btn { flex:1; background:none; border:none; color:#555; font-size:1.5rem; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        .nav-btn.active { color:var(--accent); }
        .nav-txt { font-size:0.6rem; font-weight:bold; margin-top:2px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>ARK OPS</h1>
        <div id="status" class="status">READY</div>
    </div>

    <div id="view-world" class="view active">
        <div class="card">
            <h2>SERVER CONTROL</h2>
            <div class="grid-2">
                <button class="btn" onclick="send('SaveWorld')">üíæ SAVE</button>
                <button class="btn btn-danger" onclick="confirmSend('DoExit','STOP SERVER?')">üõë STOP</button>
            </div>
            <div style="margin-top:10px"></div>
            <button class="btn btn-warn" onclick="confirmSend('DestroyWildDinos','Wipe all wild dinos?')">ü¶ñ WIPE WILD DINOS</button>
        </div>

        <div class="card">
            <h2>WEATHER & TIME</h2>
            <div class="grid-3">
                <button class="btn" onclick="send('cheat SetTimeOfDay 06:00')">üåÖ DAWN</button>
                <button class="btn" onclick="send('cheat SetTimeOfDay 12:00')">‚òÄÔ∏è NOON</button>
                <button class="btn" onclick="send('cheat SetTimeOfDay 22:00')">üåô NIGHT</button>
            </div>
            <div style="margin-top:10px"></div>
            <div class="grid-2">
                <button class="btn" onclick="send('cheat CE StopRain')">‚òÄÔ∏è CLEAR</button>
                <button class="btn" onclick="send('cheat CE StartRain')">üåßÔ∏è RAIN</button>
                <button class="btn" onclick="send('cheat CE StartFog')">üå´Ô∏è FOG</button>
                <button class="btn" onclick="send('cheat CE StartSuperHeat')">üî• HEAT</button>
            </div>
        </div>

        <div class="card">
            <h2>CONSOLE LOG</h2>
            <div id="console">System Initialized. Scanning...</div>
            <div style="display:flex; gap:5px;">
                <input type="text" id="custom" placeholder="Raw RCON Command..." style="margin:0">
                <button class="btn btn-main" style="width:80px" onclick="sendCustom()">SEND</button>
            </div>
        </div>
    </div>

    <div id="view-players" class="view">
        <div class="card">
            <button class="btn btn-main" onclick="scanPlayers()">üîÑ REFRESH PLAYERS</button>
            <div id="p-list" style="margin-top:10px;"></div>
        </div>

        <div id="p-actions" class="card" style="display:none; border-color:var(--accent);">
            <h2 id="target-name" style="color:var(--accent)">TARGET: NONE</h2>
            
            <div class="grid-2">
                <button class="btn btn-main" onclick="pCmd('heal')">‚ù§Ô∏è HEAL</button>
                <button class="btn btn-main" onclick="pCmd('xp')">‚ú® +XP</button>
                <button class="btn btn-danger" onclick="pCmd('kick')">ü•æ KICK</button>
                <button class="btn btn-danger" onclick="pCmd('kill')">üíÄ KILL</button>
            </div>

            <h2 style="margin-top:15px;">KITS (AUTO-GIVE)</h2>
            <div class="grid-2" style="margin-top:10px">
                <button class="btn btn-warn" onclick="giveKit('starter')">üê£ STARTER</button>
                <button class="btn btn-warn" onclick="giveKit('pvp')">‚öîÔ∏è PVP</button>
                <button class="btn btn-warn" onclick="giveKit('tek')">ü§ñ TEK</button>
                <button class="btn btn-warn" onclick="giveKit('build')">üèóÔ∏è BUILDER</button>
                <button class="btn btn-warn" onclick="giveKit('tame')">ü•© TAMER</button>
                <button class="btn btn-warn" onclick="giveKit('boss')">üëπ BOSS</button>
                <button class="btn btn-warn" onclick="giveKit('scuba')">ü§ø OCEAN</button>
                <button class="btn btn-warn" onclick="giveKit('desert')">üåµ DESERT</button>
            </div>
        </div>
    </div>

    <div id="view-spawn" class="view">
        <div style="position:sticky; top:70px; background:var(--bg); padding-bottom:5px; z-index:80;">
            <select id="spawn-target">
                <option value="">üö´ SELECT PLAYER FIRST (IN PLAYERS TAB)</option>
            </select>
            <input type="text" id="search" placeholder="üîç Search Items..." onkeyup="renderItems()">
        </div>
        <div id="item-list"></div>
    </div>

    <div class="nav">
        <button class="nav-btn active" onclick="tab('world',this)"><span>üåç</span><span class="nav-txt">WORLD</span></button>
        <button class="nav-btn" onclick="tab('players',this)"><span>üë§</span><span class="nav-txt">PLAYERS</span></button>
        <button class="nav-btn" onclick="tab('spawn',this)"><span>üéí</span><span class="nav-txt">SPAWN</span></button>
    </div>

<script>
    // --- DATABASE ---
    const ITEMS = [
        {n:"Tek Rifle", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Weapons/PrimalItem_TekRifle.PrimalItem_TekRifle'"},
        {n:"Tek Helmet", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Tek/PrimalItemArmor_TekHelmet.PrimalItemArmor_TekHelmet'"},
        {n:"Tek Chest", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Tek/PrimalItemArmor_TekShirt.PrimalItemArmor_TekShirt'"},
        {n:"Tek Legs", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Tek/PrimalItemArmor_TekPants.PrimalItemArmor_TekPants'"},
        {n:"Tek Boots", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Tek/PrimalItemArmor_TekBoots.PrimalItemArmor_TekBoots'"},
        {n:"Element (100)", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Resources/PrimalItemResource_Element.PrimalItemResource_Element'", q:100},
        {n:"Polymer (500)", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Resources/PrimalItemResource_Polymer.PrimalItemResource_Polymer'", q:500},
        {n:"Heavy Turret", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Structures/Misc/PrimalItemStructure_TurretTek.PrimalItemStructure_TurretTek'"},
        {n:"Fab Sniper", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Weapons/PrimalItem_WeaponMachinedSniper.PrimalItem_WeaponMachinedSniper'"},
        {n:"Sniper Ammo (100)", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Weapons/PrimalItemAmmo_AdvancedSniperBullet.PrimalItemAmmo_AdvancedSniperBullet'", q:100},
        {n:"Pump Shotgun", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Weapons/PrimalItem_WeaponGun_PumpShotgun.PrimalItem_WeaponGun_PumpShotgun'"},
        {n:"Shotgun Ammo (100)", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Weapons/PrimalItemAmmo_SimpleShotgunBullet.PrimalItemAmmo_SimpleShotgunBullet'", q:100},
        {n:"Flak Helmet", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Metal/PrimalItemArmor_MetalHelmet.PrimalItemArmor_MetalHelmet'"},
        {n:"Flak Chest", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Metal/PrimalItemArmor_MetalShirt.PrimalItemArmor_MetalShirt'"},
        {n:"Rex Saddle", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Saddles/PrimalItemArmor_RexSaddle.PrimalItemArmor_RexSaddle'"},
        {n:"Giga Saddle", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Saddles/PrimalItemArmor_GigantSaddle.PrimalItemArmor_GigantSaddle'"},
        {n:"Carchar Saddle", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Armor/Saddles/PrimalItemArmor_Carcha.PrimalItemArmor_Carcha'"},
        {n:"Medbrew (100)", p:"Blueprint'/Game/PrimalEarth/CoreBlueprints/Items/Consumables/PrimalItemConsumable_HealSoup.PrimalItemConsumable_HealSoup'", q:100}
    ];

    let targetID = null;

    // --- CORE ---
    async function send(cmd) {
        log(`> ${cmd}`);
        try {
            // NO PASSWORD SENT HERE
            const res = await fetch('/api/command', {
                method:'POST', headers:{'Content-Type':'application/json'},
                body:JSON.stringify({command:cmd}) 
            });
            const data = await res.json();
            
            log(`< ${data.response}`);
            document.getElementById('status').innerText = "ONLINE";
            document.getElementById('status').classList.add('on');
            return data.response;
        } catch(e) {
            log("‚ùå ERROR: Connection Failed");
            document.getElementById('status').innerText = "OFFLINE";
            document.getElementById('status').classList.remove('on');
        }
    }

    function log(m) { const c=document.getElementById('console'); c.innerHTML+=`<div>${m}</div>`; c.scrollTop=c.scrollHeight; }

    // --- PLAYERS ---
    async function scanPlayers() {
        const res = await send("ListPlayers");
        const list = document.getElementById('p-list');
        const drop = document.getElementById('spawn-target');
        list.innerHTML = ""; drop.innerHTML = '<option value="">Select Player...</option>';

        // ARK Player List Regex
        const matches = res.matchAll(/(\d+)\.\s(.*?),\s([0-9a-fA-F]+)/g);
        let found = false;
        
        for(const m of matches) {
            found = true;
            const name = m[2]; const id = m[3];
            const div = document.createElement('div');
            div.style.background = '#222'; div.style.padding='10px'; div.style.marginBottom='5px'; div.style.display='flex'; div.style.justifyContent='space-between';
            div.innerHTML = `<span><b>${name}</b> <small>(${id})</small></span> <button style="background:var(--accent); border:none; padding:5px 10px; cursor:pointer;" onclick="sel('${id}','${name}')">SELECT</button>`;
            list.appendChild(div);
            drop.add(new Option(name, id));
        }
        if(!found) list.innerHTML = "<div style='text-align:center; color:#555;'>No Players Online</div>";
    }

    function sel(id, name) {
        targetID = id;
        document.getElementById('target-name').innerText = `TARGET: ${name}`;
        document.getElementById('p-actions').style.display = 'block';
        document.getElementById('spawn-target').value = id;
        tab('players', document.querySelectorAll('.nav-btn')[1]);
    }

    // --- ACTIONS ---
    function pCmd(type) {
        if(!targetID) return alert("SELECT PLAYER FIRST");
        if(type==='heal') send(`ScriptCommand RefillStats ${targetID}`);
        if(type==='xp') send(`GiveExpToPlayer ${targetID} 5000 0 0`);
        if(type==='kick') send(`KickPlayer ${targetID}`);
        if(type==='kill') send(`KillPlayer ${targetID}`);
    }

    async function giveKit(k) {
        if(!targetID) return alert("SELECT PLAYER FIRST");
        const id = targetID;
        alert(`Sending Kit: ${k.toUpperCase()}... Check Console.`);
        
        let items = [];
        if(k==='starter') items = [ITEMS[12].p, ITEMS[13].p, ITEMS[10].p]; 
        if(k==='pvp') items = [ITEMS[0].p, ITEMS[1].p, ITEMS[2].p, ITEMS[3].p, ITEMS[4].p, ITEMS[8].p, ITEMS[17].p]; 
        if(k==='tek') items = [ITEMS[5].p, ITEMS[1].p, ITEMS[2].p, ITEMS[3].p, ITEMS[4].p]; 
        if(k==='build') items = [ITEMS[7].p]; 
        
        for(const bp of items) {
            await send(`GiveItemToPlayer ${id} "${bp}" 1 0 0`);
        }
    }

    function renderItems() {
        const q = document.getElementById('search').value.toLowerCase();
        const box = document.getElementById('item-list'); box.innerHTML = "";
        ITEMS.forEach(i => {
            if(i.n.toLowerCase().includes(q)) {
                const d = document.createElement('div');
                d.style.background='#1a1a1a'; d.style.padding='10px'; d.style.marginBottom='5px'; d.style.display='flex'; d.style.justifyContent='space-between';
                d.innerHTML = `<span>${i.n}</span> <button style="background:var(--warn); border:none; padding:5px 10px;" onclick="gItem('${i.p}',${i.q||1})">GIVE</button>`;
                box.appendChild(d);
            }
        });
    }

    async function gItem(bp, q) {
        const id = document.getElementById('spawn-target').value;
        if(!id) return alert("SELECT PLAYER FIRST");
        await send(`GiveItemToPlayer ${id} "${bp}" ${q} 0 0`);
    }

    // UTILS
    function tab(v,b) {
        document.querySelectorAll('.view').forEach(x=>x.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(x=>x.classList.remove('active'));
        document.getElementById('view-'+v).classList.add('active');
        b.classList.add('active');
    }
    function sendCustom(){ const c=document.getElementById('custom').value; if(c) send(c); }
    function confirmSend(c,m){ if(confirm(m)) send(c); }

    // Init instantly
    renderItems();
    setTimeout(scanPlayers, 1000); // Auto-scan after 1s
</script>
</body>
</html>
